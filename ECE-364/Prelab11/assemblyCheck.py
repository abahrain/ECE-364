#! /usr/bin/env python2.6
#
#$Author: ee364f04 $
#$Date: 2013-03-27 21:28:49 -0400 (Wed, 27 Mar 2013) $
#$HeadURL: svn+ssh://ece364sv@ecegrid-lnx/home/ecegrid/a/ece364sv/svn/S13/students/ee364f04/Prelab11/assemblyCheck.py $
#$Revision: 54904 $

import sys
import os
import re

n=sys.argv[1:]

if len(sys.argv) != 2:
    print "Usage: assemblyCheck.py <infile>"
    sys.exit(1)
if not os.access(n[0],os.R_OK):
    print "%s is not readable" % (n[0],)
    sys.exit(2)

fp=open(sys.argv[1])

for line in fp:
    if re.match("^lw \$t[0-7],((\$t[0-7])|(![0-9]+)|([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-9]{2}|3[0-9]{2}|4[0-9]{2}|5[0-9]{2}|6[0-9]{2}|7[0-9]{2}|8[0-9]{2}|9[0-9]{2}|10[0-1][0-9]|102[0-4]))",line):
        continue
    elif re.match("sw \$t[0-7],((\$t[0-7])|(![0-9]+)|([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-9]{2}|3[0-9]{2}|4[0-9]{2}|5[0-9]{2}|6[0-9]{2}|7[0-9]{2}|8[0-9]{2}|9[0-9]{2}|10[0-1][0-9]|102[0-4]))",line):
        continue
    elif re.match("add \$t[0-7],((\$t[0-7])|(![0-9]+)|([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-9]{2}|3[0-9]{2}|4[0-9]{2}|5[0-9]{2}|6[0-9]{2}|7[0-9]{2}|8[0-9]{2}|9[0-9]{2}|10[0-1][0-9]|102[0-4]))",line):
        continue
    elif re.match("sub \$t[0-7],((\$t[0-7])|(![0-9]+)|([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-9]{2}|3[0-9]{2}|4[0-9]{2}|5[0-9]{2}|6[0-9]{2}|7[0-9]{2}|8[0-9]{2}|9[0-9]{2}|10[0-1][0-9]|102[0-4]))",line):
        continue
    elif re.match("mul \$t[0-7],((\$t[0-7])|(![0-9]+)|([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-9]{2}|3[0-9]{2}|4[0-9]{2}|5[0-9]{2}|6[0-9]{2}|7[0-9]{2}|8[0-9]{2}|9[0-9]{2}|10[0-1][0-9]|102[0-4]))",line):
        continue
    elif re.match("div \$t[0-7],((\$t[0-7])|(![0-9]+)|([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-9]{2}|3[0-9]{2}|4[0-9]{2}|5[0-9]{2}|6[0-9]{2}|7[0-9]{2}|8[0-9]{2}|9[0-9]{2}|10[0-1][0-9]|102[0-4]))",line):
        continue
    elif re.match("beq \$t[0-7],((\$t[0-7])|(![0-9]+)|([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-9]{2}|3[0-9]{2}|4[0-9]{2}|5[0-9]{2}|6[0-9]{2}|7[0-9]{2}|8[0-9]{2}|9[0-9]{2}|10[0-1][0-9]|102[0-4]))",line):
        continue
    elif re.match("jmp \$t[0-7],((\$t[0-7])|(![0-9]+)|([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-9]{2}|3[0-9]{2}|4[0-9]{2}|5[0-9]{2}|6[0-9]{2}|7[0-9]{2}|8[0-9]{2}|9[0-9]{2}|10[0-1][0-9]|102[0-4]))",line):
        continue
    else:
        print "Error: invalid line %s" % (line,)

sys.exit(0)
